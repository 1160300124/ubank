<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 
	namespace：必须与对应的接口全类名一致
	id:必须与对应接口的某个对应的方法名一致
	
 -->
<mapper namespace="com.ulaiber.web.dao.AttendanceRuleDao">
    <resultMap id="AttendanceRuleMap" type="AttendanceRule" >
    	<id column="rid" property="rid" jdbcType="BIGINT" />
    	<result column="clock_on_time" property="clockOnTime" jdbcType="VARCHAR" />
    	<result column="clock_off_time" property="clockOffTime" jdbcType="VARCHAR" />
    	<result column="clock_on_advance_hours" property="clockOnAdvanceHours" jdbcType="INTEGER" />
    	<result column="clock_on_start_time" property="clockOnStartTime" jdbcType="VARCHAR" />
    	<result column="clock_off_delay_hours" property="clockOffDelayHours" jdbcType="INTEGER" />
    	<result column="clock_off_end_time" property="clockOffEndTime" jdbcType="VARCHAR" />
	   	<result column="rest_start_time" property="restStartTime" jdbcType="VARCHAR" />
    	<result column="rest_end_time" property="restEndTime" jdbcType="VARCHAR" />
		<result column="longit_latit" property="longit_latit" jdbcType="VARCHAR" />    	
    	<result column="clock_location" property="clockLocation" jdbcType="VARCHAR" />
    	<result column="clock_bounds" property="clockBounds" jdbcType="INTEGER" />
   </resultMap>
  
	 <!-- mybsits_config中配置的alias类别名,也可直接配置resultType为类路劲 -->  
	<insert id="save" parameterType="AttendanceRule" >
		insert into tbl_attendance_rules(clock_on_time,clock_off_time,clock_on_advance_hours,clock_on_start_time,clock_off_delay_hours,clock_off_end_time,
			rest_start_time,rest_end_time,longit_latit,clock_location,clock_bounds) values(#{clockOnTime}, #{clockOffTime}, #{clockOnAdvanceHours}, 
			#{clockOnStartTime}, #{clockOffDelayHours}, #{clockOffEndTime}, #{restStartTime}, #{restEndTime}, #{longit_latit}, #{clockLocation}, #{clock_bounds}) 
	</insert>
	
	<update id="update" parameterType="AttendanceRule">
		update tbl_attendance_rules set clock_on_time=#{clockOnTime},clock_off_time=#{clockOffTime},clock_on_advance_hours=#{clockOnAdvanceHours},
			clock_on_start_time=#{clockOnStartTime},clock_off_delay_hours=#{clockOffDelayHours},clock_off_end_time=#{clockOffEndTime},rest_start_time=#{restStartTime},
			rest_end_time=#{restEndTime},longit_latit=#{longit_latit},clock_location=#{clockLocation},clock_bounds=#{clock_bounds}
	</update>
	
	<select id="getRuleByUserId" parameterType="Long" resultMap="AttendanceRuleMap">
		select a.* from tbl_attendance_rules a left join tbl_users_of_rules r on a.rid=r.rid where r.userid=#{userId}
	</select>
	
	<select id="getRuleByMobile" parameterType="String" resultMap="AttendanceRuleMap">
		select a.* from tbl_attendance_rules a left join tbl_users_of_rules r on a.rid=r.rid left join tbl_users u on r.userid=u.user_id where u.mobile=#{mobile}
	</select>

</mapper>